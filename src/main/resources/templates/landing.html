<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="#{app.title}">Debt Wallet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/wallet.css}">
    <meta name="_csrf" th:content="${_csrf?.token}" />
    <meta name="_csrf_header" th:content="${_csrf?.headerName}" />
</head>

<body class="landing-page">

    <!-- Navigation -->
    <nav class="landing-nav">
        <div class="container d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
                <i class="fas fa-wallet fa-2x text-primary me-2"></i>
                <h4 class="mb-0 fw-bold" th:text="#{app.title}">Debt Wallet</h4>
            </div>
            <div class="d-none d-md-flex gap-4 align-items-center">
                <a href="#features" class="text-white text-decoration-none"
                    th:text="#{landing.nav.features}">Features</a>
                <a href="#pricing" class="text-white text-decoration-none" th:text="#{landing.nav.pricing}">Pricing</a>
                <a href="#" class="text-white text-decoration-none" th:text="#{landing.nav.about}">About</a>
            </div>
            <!-- Authenticated User Info -->
            <div class="d-flex align-items-center gap-3" sec:authorize="isAuthenticated()">
                <a th:href="@{/settings/profile}" class="text-white text-decoration-none fw-bold">
                    <i class="fas fa-user-circle me-1"></i>
                    <span th:text="${#authentication.name}">Username</span>
                </a>
            </div>

            <!-- Guest Links -->
            <div class="d-flex gap-3" sec:authorize="!isAuthenticated()">
                <a th:href="@{/login}" class="btn text-white" th:text="#{landing.nav.login}">Login</a>
                <a th:href="@{/login}" class="btn btn-primary" th:text="#{landing.nav.get_started}">Get Started</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="landing-hero">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <span class="hero-badge" th:text="#{landing.hero.badge}">TAKE CONTROL TODAY</span>
                    <h1 class="hero-title">
                        <span th:text="#{landing.hero.title_part1}">Manage Your Debt,</span><br>
                        <span class="highlight" th:text="#{landing.hero.title_part2}">Secure Your Future</span>
                    </h1>
                    <p class="hero-description" th:text="#{landing.hero.description}">
                        A simple, secure way to track, manage, and accelerate your journey to financial freedom.
                    </p>
                    <div class="d-flex gap-3">
                        <a th:href="@{/wallet}" sec:authorize="isAuthenticated()" class="btn btn-primary btn-lg px-4"
                            th:text="#{landing.nav.dashboard}">Dashboard</a>
                        <button sec:authorize="!isAuthenticated()" class="btn btn-primary btn-lg px-4"
                            data-bs-toggle="modal" data-bs-target="#subscriptionModal"
                            th:text="#{landing.hero.btn.started}">Get Started for Free</button>
                        <a href="#" class="btn btn-outline-light btn-lg px-4" th:text="#{landing.hero.btn.demo}">View
                            Demo</a>
                    </div>
                    <div class="mt-5 d-flex align-items-center">
                        <div class="d-flex me-3">
                            <div class="rounded-circle bg-secondary border border-dark"
                                style="width: 32px; height: 32px; margin-right: -10px;"></div>
                            <div class="rounded-circle bg-primary border border-dark"
                                style="width: 32px; height: 32px; margin-right: -10px;"></div>
                            <div class="rounded-circle bg-info border border-dark" style="width: 32px; height: 32px;">
                            </div>
                        </div>
                        <small class="text-muted" th:text="#{landing.hero.trusted}">Trusted by 5,000+ debt-free
                            seekers</small>
                    </div>
                </div>
                <div class="col-lg-6 d-none d-lg-block">
                    <div class="hero-image-container">
                        <div class="bg-white rounded-3 p-4 shadow-lg mb-4">
                            <div class="d-flex justify-content-between mb-3">
                                <div class="h-100 bg-light rounded" style="width: 40%; height: 20px;"></div>
                                <div class="h-100 bg-primary rounded" style="width: 20%; height: 20px;"></div>
                            </div>
                            <div class="d-flex gap-3 align-items-end">
                                <div class="bg-primary-subtle rounded-top" style="width: 25%; height: 100px;"></div>
                                <div class="bg-primary rounded-top" style="width: 25%; height: 150px;"></div>
                                <div class="bg-primary-subtle rounded-top" style="width: 25%; height: 80px;"></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-3 p-4 shadow-lg ms-5">
                            <div class="bg-light rounded mb-2" style="width: 80%; height: 15px;"></div>
                            <div class="bg-light rounded mb-2" style="width: 60%; height: 15px;"></div>
                            <div class="bg-primary rounded" style="width: 40%; height: 15px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Workspace Selection (Logged In Only) -->
    <section th:if="${workspaces != null and !workspaces.isEmpty()}" class="workspace-section bg-dark py-5">
        <div class="container text-center">
            <h2 class="display-6 fw-bold mb-4 text-white" th:text="#{landing.workspaces.title}">Select Your Workspace
            </h2>
            <div class="row g-4 justify-content-center">
                <div th:each="workspace : ${workspaces}" class="col-md-4 col-lg-3">
                    <div class="card bg-secondary text-white border-0 shadow-sm h-100">
                        <div class="card-body d-flex flex-column align-items-center p-4">
                            <div class="rounded-circle bg-primary mb-3 d-flex align-items-center justify-content-center"
                                style="width: 60px; height: 60px;">
                                <i class="fas fa-briefcase fa-lg"></i>
                            </div>
                            <h5 class="card-title fw-bold" th:text="${workspace.name()}">Workspace Name</h5>
                            <p class="small text-white-50 mb-4" th:text="${workspace.slug()}">slug</p>
                            <a th:href="@{/w/{slug}(slug=${workspace.slug()})}" class="btn btn-primary mt-auto w-100"
                                th:text="#{landing.workspaces.select}">Go to Workspace</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="feature-section">
        <div class="container text-center">
            <h2 class="display-5 fw-bold mb-3" th:text="#{landing.features.title}">Simplify Your Finances</h2>
            <p class="text-muted mx-auto mb-5" style="max-width: 600px;" th:text="#{landing.features.description}">
                Our MVP provides the essential tools to regain control of your debt.
            </p>
            <div class="row g-4 text-start">
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
                        <h4 class="fw-bold mb-3" th:text="#{landing.feature.tracking.title}">Debt Tracking</h4>
                        <p class="text-muted mb-0" th:text="#{landing.feature.tracking.desc}">Unified view of all your
                            balances in one secure location.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-bell"></i></div>
                        <h4 class="fw-bold mb-3" th:text="#{landing.feature.alerts.title}">Payment Alerts</h4>
                        <p class="text-muted mb-0" th:text="#{landing.feature.alerts.desc}">Never miss a due date with
                            automated notifications.</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                        <h4 class="fw-bold mb-3" th:text="#{landing.feature.strategy.title}">Strategy Builder</h4>
                        <p class="text-muted mb-0" th:text="#{landing.feature.strategy.desc}">Visualize and compare
                            Snowball vs. Avalanche repayment methods.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing Section -->
    <section id="pricing" class="pricing-section bg-dark-subtle py-5">
        <div class="container text-center py-5">
            <h2 class="display-5 fw-bold mb-3" th:text="#{landing.pricing.title}">Pricing Plans</h2>
            <p class="text-muted mx-auto mb-5" style="max-width: 600px;" th:text="#{landing.pricing.description}">
                Start for free and upgrade as you scale.
            </p>
            <div class="row g-4">
                <div class="col-lg-4">
                    <div class="pricing-card">
                        <h5 class="fw-bold mb-4" th:text="#{landing.pricing.free.name}">Basic</h5>
                        <div class="price-value">$<span th:text="#{landing.pricing.free.price}">0</span><small
                                class="fs-6 fw-normal text-muted">/month</small></div>
                        <p class="text-muted" th:text="#{landing.pricing.free.desc}">Perfect for individuals starting
                            their journey.</p>
                        <ul class="pricing-features">
                            <li><i class="fas fa-check-circle"></i> Manual debt tracking</li>
                            <li><i class="fas fa-check-circle"></i> 1 Linked account</li>
                            <li><i class="fas fa-check-circle"></i> Basic progress charts</li>
                        </ul>
                        <button class="btn btn-outline-light w-100 p-3 fw-bold" data-bs-toggle="modal"
                            data-bs-target="#subscriptionModal" th:text="#{landing.pricing.free.btn}">Start
                            Free</button>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="pricing-card opacity-50 border-secondary">
                        <span class="badge bg-warning text-dark mb-4 px-3 py-2"
                            th:text="#{landing.pricing.pro.badge}">UNDER STUDY</span>
                        <h5 class="fw-bold mb-4" th:text="#{landing.pricing.pro.name}">Pro</h5>
                        <div class="price-value text-muted">$<span th:text="#{landing.pricing.pro.price}">9</span><small
                                class="fs-6 fw-normal text-muted">/month</small></div>
                        <p class="text-muted" th:text="#{landing.pricing.pro.desc}">Automate your finances and reach
                            your goals faster.</p>
                        <p class="small text-warning" th:text="#{landing.pricing.plan.deactivated}">Under study.</p>
                        <ul class="pricing-features text-muted">
                            <li><i class="fas fa-times-circle text-secondary"></i> Auto-sync bank accounts</li>
                            <li><i class="fas fa-times-circle text-secondary"></i> Unlimited accounts</li>
                            <li><i class="fas fa-times-circle text-secondary"></i> Advanced payoff comparison</li>
                            <li><i class="fas fa-times-circle text-secondary"></i> Priority chat support</li>
                        </ul>
                        <button class="btn btn-outline-secondary w-100 p-3 fw-bold" disabled
                            th:text="#{landing.pricing.pro.btn}">Go Pro</button>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="pricing-card opacity-50 border-secondary">
                        <h5 class="fw-bold mb-4 text-muted" th:text="#{landing.pricing.enterprise.name}">Enterprise</h5>
                        <div class="price-value text-muted" th:text="#{landing.pricing.enterprise.price}">Custom</div>
                        <p class="text-muted" th:text="#{landing.pricing.enterprise.desc}">Tailored solutions for
                            financial advisors.</p>
                        <p class="small text-warning" th:text="#{landing.pricing.plan.deactivated}">Under study.</p>
                        <ul class="pricing-features text-muted">
                            <li><i class="fas fa-times-circle text-secondary"></i> Multi-client management</li>
                            <li><i class="fas fa-times-circle text-secondary"></i> Full API access</li>
                            <li><i class="fas fa-times-circle text-secondary"></i> Custom report branding</li>
                        </ul>
                        <button class="btn btn-outline-secondary w-100 p-3 fw-bold" disabled
                            th:text="#{landing.pricing.enterprise.btn}">Contact Sales</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Subscription Modal -->
    <div class="modal fade" id="subscriptionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content bg-dark text-white border-secondary">
                <div class="modal-header border-secondary">
                    <h5 class="modal-title" th:text="#{subscription.modal.title}">Join Early Access</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="subscriptionForm">
                        <div class="mb-3">
                            <label class="form-label" th:text="#{subscription.label.email}">Email</label>
                            <input type="email" class="form-control bg-dark text-white border-secondary" id="subEmail"
                                required>
                        </div>
                        <div id="subAlert" class="alert d-none"></div>
                    </form>
                </div>
                <div class="modal-footer border-secondary">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                        th:text="#{btn.cancel}">Cancel</button>
                    <button type="button" class="btn btn-primary" id="btnSubscribe"
                        th:text="#{subscription.btn.subscribe}">Subscribe</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CTA Section -->
    <div class="container">
        <div class="cta-banner">
            <h2 class="display-4 fw-bold mb-4" th:text="#{landing.cta.title}">Ready to be debt-free?</h2>
            <p class="fs-5 text-white-50 mb-5" th:text="#{landing.cta.description}">Join thousands of users taking
                control of their financial future today.</p>
            <a th:href="@{/wallet}" sec:authorize="isAuthenticated()"
                class="btn btn-light btn-lg px-5 py-3 fw-bold text-primary"
                th:text="#{landing.nav.dashboard}">Dashboard</a>
            <button sec:authorize="!isAuthenticated()" class="btn btn-light btn-lg px-5 py-3 fw-bold text-primary"
                data-bs-toggle="modal" data-bs-target="#subscriptionModal" th:text="#{landing.cta.btn}">Create Your Free
                Account</button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="landing-footer">
        <div class="container">
            <div class="row">
                <div class="col-lg-6 mb-4">
                    <div class="d-flex align-items-center mb-4">
                        <i class="fas fa-wallet fa-2x text-primary me-2"></i>
                        <h4 class="mb-0 fw-bold" th:text="#{app.title}">Debt Wallet</h4>
                    </div>
                    <p class="text-muted w-75" th:text="#{landing.footer.tagline}">Empowering millions to reclaim their
                        financial independence.</p>
                </div>
                <div class="col-lg-3 mb-4">
                    <h6 class="fw-bold mb-4 text-white" th:text="#{landing.footer.product}">Product</h6>
                    <a href="#" class="footer-link" th:text="#{landing.nav.features}">Features</a>
                    <a href="#" class="footer-link" th:text="#{landing.nav.pricing}">Pricing</a>
                    <a href="#" class="footer-link" th:text="#{status.loading}">Security</a>
                </div>
                <div class="col-lg-3 mb-4">
                    <h6 class="fw-bold mb-4 text-white" th:text="#{landing.footer.legal}">Legal</h6>
                    <a href="#" class="footer-link">Privacy Policy</a>
                    <a href="#" class="footer-link">Terms of Service</a>
                    <a href="#" class="footer-link">Cookie Policy</a>
                </div>
            </div>
            <hr class="my-5 border-secondary opacity-25">
            <div class="d-flex justify-content-between align-items-center flex-column flex-md-row gap-3">
                <p class="text-muted small mb-0" th:text="#{landing.footer.copyright}">Â© 2024 Debt Wallet. All rights
                    reserved.</p>
                <div class="text-muted small" th:text="#{landing.footer.minimalist}">A Minimalist FinTech Product.</div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script th:inline="javascript">
        document.getElementById('btnSubscribe').addEventListener('click', async () => {
            const email = document.getElementById('subEmail').value;
            const alert = document.getElementById('subAlert');
            const btn = document.getElementById('btnSubscribe');
            const csrfToken = document.querySelector('meta[name="_csrf"]')?.content || /*[[${_csrf?.token}]]*/ '';

            if (!email) return;

            btn.disabled = true;
            try {
                const response = await fetch('/api/subscription/request', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'X-CSRF-TOKEN': csrfToken
                    },
                    body: new URLSearchParams({ email: email })
                });

                if (response.ok) {
                    alert.className = 'alert alert-success mt-3';
                    alert.innerText = /*[[#{subscription.success}]]*/ 'Success';
                    alert.classList.remove('d-none');
                    setTimeout(() => bootstrap.Modal.getInstance(document.getElementById('subscriptionModal')).hide(), 2000);
                } else {
                    alert.className = 'alert alert-danger mt-3';
                    alert.innerText = 'Error processing request.';
                    alert.classList.remove('d-none');
                    btn.disabled = false;
                }
            } catch (e) {
                alert.className = 'alert alert-danger mt-3';
                alert.innerText = 'Connection error.';
                alert.classList.remove('d-none');
                btn.disabled = false;
            }
        });
    </script>
</body>

</html>